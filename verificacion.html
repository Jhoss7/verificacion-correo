<!DOCTYPE html>
<html>
<head>
  <title>Acceso a Google Sheets</title>
</head>
<body>
  <h1>Acceso a Google Sheets</h1>
  <p id="verificationStatusMessage">¡Hola, tu correo ha sido VERIFICADO!</p>

  <div id="tokenDisplay">
    <!-- Aquí se mostrará el token -->
  </div>
  <h1>Datos del Google Sheet</h1>
  <div id="sheetData"></div>

  <a href="javascript:void(0);" id="saveTokenLink">Guardar Token en Google Sheets</a>

  <script>
    // Obtén el token de la URL
    var urlParams = new URLSearchParams(window.location.search);
    var token = urlParams.get('token');

    // Verifica si se ha encontrado un token en la URL
    if (token) {
      // Muestra el token en el elemento 'tokenDisplay'
      var tokenDisplay = document.getElementById('tokenDisplay');
      tokenDisplay.textContent = 'Token: ' + token;

      // Manejar el evento de clic en el enlace para guardar el token
      var saveTokenLink = document.getElementById('saveTokenLink');
      saveTokenLink.addEventListener('click', function () {
        // Llama a la función para guardar el token en Google Sheets
        guardarTokenEnGoogleSheets(token);
      });
    }

    // Función para guardar el token en Google Sheets
    function guardarTokenEnGoogleSheets(token) {
      // Reemplaza 'TU_CLIENT_ID' con el ID de cliente de OAuth 2.0 de tu proyecto
      var clientId = '816453436793-mfrd0gmqokedqouu4hi8lbolle7tgej6.apps.googleusercontent.com';

      // Configura las credenciales de OAuth 2.0
      gapi.load('client', function () {
        gapi.client.init({
          'clientId': clientId,
          'scope': 'https://www.googleapis.com/auth/spreadsheets',
        }).then(function () {
          // Identifica la hoja de cálculo donde deseas guardar el token
          var spreadsheetId = '1eO13HkJDyaTu-g7hqr-Wxpm5UzEW0gBnL8EPJOAEdBY';
          var range = 'Hoja 1'; // Cambia a la hoja que necesites

          // Crea un objeto de datos para enviar al Google Sheet
          var values = [[token]];

          // Realiza una solicitud para agregar una fila con el token
          gapi.client.sheets.spreadsheets.values.append({
            spreadsheetId: spreadsheetId,
            range: range,
            valueInputOption: 'RAW',
            insertDataOption: 'INSERT_ROWS',
            values: values,
          }).then(function (response) {
            var result = response.result;
            console.log('Token guardado en Google Sheets:', result);
          });
        });
      });
    }
  </script>
  <script src="https://apis.google.com/js/api.js"></script>
</body>
</html>



